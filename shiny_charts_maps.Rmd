---
title: "Paid Leave Predictor"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    source_code: embed
    runtime: shiny
---

This won't run until we add a website with something like this syntax in the site_yml, but I made a dummy website to test some of it:

  right:
    - text: "Report"
      href: project_report.html
    - text: "Paid Leave Dashboard"
      href: shiny_charts_maps.html
      
      (eventually these would become href: https://uni-shiny.shinyapps.io/page_name/)

```{r, include=FALSE}
library(tidyverse)
library(p8105.datasets)
library(plotly)
library(flexdashboard)
library(shiny)

charts_df = 
  read_csv("./data/merged_wfls.csv")

```


TO ADD:
* Option to select all of NYC
* Remove "did not take leave"?
* Bar graph that incorporates 2 factors (select one or select 2 together)?
* Maps that allow you to select 2 factors? Or compare maps feature where you can place multiple beside one another?


Weeks of Paid Maternity Leave Predictor
=====================================

Column {.sidebar}

```{r}

#entries to choose from
borough_choices = 
  charts_df %>% 
  pull(borough) %>%  
  unique()

type = charts_df %>% 
  pull(leave_type) %>% unique()

race = charts_df %>% 
  pull(race) %>% unique()

partner = charts_df %>% 
  pull(partner) %>% unique()

education = charts_df %>% 
  pull(education) %>% unique()

employment = charts_df %>% 
  pull(job_type) %>% unique()

food_insecurity = charts_df %>% 
  pull(food_insecurity) %>% unique()

selectInput(
  "borough_choice",
  h3("Borough"),
  choices = borough_choices,
  selected = "Manhattan"
)

radioButtons(
  "type",
  h3("Type of Leave"),
  choices = type,
  selected = NULL)
  
sliderInput(
  "income",
  h3("Family Income"),
  0,100000,
  value = c(0,100000))

radioButtons(
  "race",
  h3("Race"),
  choices = race,
  selected = NULL
  )

radioButtons(
  "partner",
  h3("Co-parenting Status"),
  choices = partner,
  selected = NULL
  )

radioButtons(
  "education",
  h3("Educational Attainment"),
  choices = education,
  selected = NULL
  )

radioButtons(
  "employment",
  h3("Employment Type"),
  choices = employment,
  selected = NULL
  )

checkboxInput(
  "food_insecurity",
  h3("Food Insecure"),
  selected = NULL
  )

```

Add some sort of renderText or renderSummary description with the prediction

Charts
===================================== 

Column {.sidebar}
-----------------------------------------------------------------------

```{r}
selectInput(
  "borough_choice",
  h3("Choose a Borough"),
  choices = borough_choices,
  selected = "Manhattan"
)

selectInput(
  "choices",
  h3("Choose first factor"),
  choices = as.list(options),
  selected = "Race")

selectInput(
  "choices",
  h3("Choose second factor"),
  choices = as.list(options),
  selected = "Race")
```

```{r}
renderPlotly({
  charts_df %>% 
  filter(
    !is.na(leave_weeks) & borough == input$borough_choice) %>% 
  group_by(leave_weeks, race) %>% 
  summarize(mean_leave_weeks = mean(leave_weeks)) %>% 
  plot_ly(
    x = ~race, y = ~mean_leave_weeks, color = ~race,
    type = "bar", colors = "viridis") %>% 
  layout(
    title = "Title",
    x = list(title = "title"),
    y = list(title = "title"))
})
```

NYC Maps
===================================== 

```{r}
selectInput(
  "borough_choice",
  h3("Choose a Borough"),
  choices = borough_choices,
  selected = "Manhattan"
)

selectInput(
  "choices",
  h3("Choose first factor"),
  choices = as.list(options),
  selected = "Race")

selectInput(
  "choices",
  h3("Choose second factor"),
  choices = as.list(options),
  selected = "Race")
```

